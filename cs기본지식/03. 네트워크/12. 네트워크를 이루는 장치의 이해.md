## 네트워크를 이루는 장치의 이해

---

##### 네트워크를 이루는 장치의 이해

- 애플리케이션 계층: L7 스위치
  
- 전송계층 : L4 스위치
  
- 인터넷 계층(네트워크계층): 라우터, L3 스위치
  
- 데이터 링크 계층: L2 스위치, 브리지
  
- 물리 계층: NIC, 리피터, AP



##### 네트워크를 이루는 장치 #1 애플리케이션 계층

- L7 스위치 (= 로드 밸런서)
  - L7 스위치는 로드밸런서라고도 하며, 서버의 부하를 분산하는 기기입니다. 서버 이중화, 보안에 강점
  - 참고로 클라우드 서비스(AWS) 등에서 L7 스위치를 이용한 로드밸런싱은 ALB (Application Load Balancer) 컴포넌트로 하며,
    L4 스위치를 이용한 로드밸런싱은 NLB (Network Load Balancer) 컴포넌트로 합니다.
- 헬스 체크
  - L4 스위치 또는 L7 스위치 모두 헬스 체크를 통해 정상적인 서버 또는 비정상적인 서버를 판별하는데, 
    헬스 체크는 전송 주기와 재전송 횟수 등을 설정한 이후 반복적으로 서버에 요청을 보내는 것



##### 네트워크를 이루는 장치 #2 전송 계층

- L4 스위치
  - 앞서 설명한 로드밸러서의 이점(안정화, 보안적 이점)을 가지고 있음.
    1. 부하 분산
    2. 상위계층의 패킷을 분석해 트랙픽의 우선 순위를 부여할 수 있음.
       - 예를 들어 HTTP가 온다면 패킷 중 포트번호 80에 우선 순위를 부여할 수 있음
    3. 헤더를 분석해서 부하 분산을 할 수 있음.



##### 네트워크를 이루는 장치 #3 인터넷 계층

- 인터넷 계층을 처리하는 기기로는 라우터, L3 스위치가 있습니다.
  - 라우터
    - 라우팅을 하는 장비 / 라우팅은 하나 이상의 네트워크에서 경로를 선택하는 프로세스!
    - 다른 네트워크에 존재하는 장치끼리 서로 데이터를 주고받을 때 “패킷소모 최소화”, “경로 최적화"하는 장비
  - L3 스위치
    - L2 스위치의 기능 + 라우팅
    - 라우터는 소프트웨어 기반의 라우팅과 하드웨어 기반의 라우팅을 하는 것으로 나눠지는데 하드웨어 기반의 라우팅을 담당하는 장치를 L3 스위치라고합니다.



##### [부록] 데이터링크 계층과 물리 계층

- 데이터 링크 계층은 ‘이더넷 프레임’을 통해 에러 확인, 흐름 제어, 접근 제어를 담당하는 계층을 말합니다.
- 물리 계층은 무선 LAN과 유선LAN을 통해 0과 1로 이루어진 데이터를 보내는 계층을 말함



##### 네트워크를 이루는 장치 #4 데이터링크 계층

- L2 스위치
  - L2 스위치는 장치들의 MAC 주소를 MAC 주소 테이블을 통해 관리하며, 연결된 장치로부터 패킷이 왔을 때 패킷 전송을 담당합니다.
  - L2 스위치는 MAC 주소 기반, L3 스위치는 IP 주소 기반
- 브리지
  - 브리지(bridge)는 두 개의 근거리 통신망(LAN)을 상호 접속할 수 있도록 하는 통신망 연결 장치



##### [부록] 데이터링크 계층의 이더넷 프레임

- 데이터링크 계층은 이더넷 프레임을 통해 전달받은 데이터의 에러를 검출하고 캡슐화
  - Preamble: 이더넷 프레임이 시작임을 알립니다.
  - SFD(Strart Frame Delimiter): 다음 바이트부터 MAC 주소 필드가 시작됨을 알립니다.
  - DMAC, SMAC: 수신, 송신 MAC 주소를 말합니다.
  - EtherType: 데이터 계층 위의 계층인 IP 프로토콜을 정의합니다. 예를 들어 IPv4 또는 IPv6가 됩니다.
  - Payload: 전달받은 데이터
  - CRC: 에러 확인 비트
- MAC 주소
  - 컴퓨터나 노트북 등 각 장치에는 네트워크에 연결하기 위한 장치(LAN 카드)가 있는데, 이를 구별하기 위한 식별번호를 말한다.
    6바이트(48비트)로 구성된다.



##### 네트워크를 이루는 장치 #5 물리 계층

- NIC
  - LAN 카드라고 하는 네트워크 인터페이스 카드(NIC, Network Interface Card)는 2대 이상의 컴퓨터 네트워크를 구성하는 데 사용
- 리피터
  - 리피터(repeater)는 들어오는 약해진 신호 정도를 증폭하여 다른 쪽으로 전달하는 장치
    이를 통해 패킷이 더 멀리 갈 수 있습니다. 하지만 이는 광케이블이 보급됨에 따라 현재는 잘 쓰이지 않는 장치입니다.
- AP (Access Point)
  - 패킷을 복사하는 기기입니다.
    AP에 유선 LAN을 연결한 후 다른 장치에서 무선 LAN 기술(와이파이 등)을 사용하여 무선 네트워크 연결을 할 수 있습니다.



##### 유선 LAN의 기술: 전이중화 통신, CSMA/CD

- 전이중화(full duplex) 통신
  - 양쪽 장치가 동시에 송수신할 수 있는 방식을 말합니다.
  - 이는 송신로와 수신로로 나눠서 데이터를 주고받으며 현대의 고속 이더넷은 이 방식을 기반으로 통신하고 있습니다.
- CSMA/CD
  - 이전에는 유선 LAN에 ‘반이중화 통신’ 중 하나인 CSMA/CD(Carrier Sense Multiple Access with Collision Detection) 방식을 썼습니다. 이 방식은 데이터를 ‘보낸 이 후’ 충돌이 발생한다면 일정 시간 이후 재전송하는 방식을 말합니다.



##### [부록] 유선 LAN을 이루는 케이블

- 유선 LAN을 이루는 케이블로는 TP 케이블이라고 하는 트위스트 페어 케이블과 광섬유케이블이 대표적입니다.
  - 트위스트 페어 케이블
    - 하나의 케이블처럼 보이지만 실제로는 여덟개의 구리선을 두 개씩 꼬아서 묶은 케이블을 지칭합니다.
      케이블은 구리선을 실드 처리하지 않고 덮은 UTP 케이블과 실드 처리하고 덮은 STP로 나눠집니다.
      여기서 우리가 많이 볼 수 있는 케이블은 UTP 케이블로 흔히 LAN 케이블이라고 합니다.
      참고로 이 LAN 케이블을 꽂을 수 있는 커넥터를 RJ-45 커넥터라고 합니다.
  - 광섬유 케이블
    - 레이저를 이용해서 통신하기 때문에 구리선과는 비교할 수 없을 만큼의 장거리 및 고속 통신이 가능합니다.
      보통 100Gbps의 데이터를 전송하며 다음 그림처럼 광섬유 내부와 외부를 다른 밀도를 가지는 유리나 플라스틱 섬유로 제작해서 한 번 들어간 빛이 내부에서 계속적으로 반사하며 전진하여 반대편 끝까지 가는 원리를 이용한 것입니다.
      참고로 빛의 굴절률이 높은 부분을 코어(core)라고 하며 낮은 부분을 클래딩(cladding)이라고 합니다.



##### 무선LAN을 이루는 기술 : 반이중화 통신, CSMA/CA, 와이파이, BSS, ESS

- 반이중화 통신(half duplex)은 양쪽 장치는 서로 통신할 수 있지만, 동시에는 통신할 수 없으며 한 번에 한 방향만 통신할 수 있는 방식
- CSMA/CA는 반이중화 통신 중 하나로 장치에서 데이터를 보내기 전에 캐리어 감지(회선이 비어 있는지를 판단) 등으로 사전에 가능한 한 충돌을 방지하는 방식을 사용하며 과정
- 와이파이(wifi)는 전자기기들이 무선 LAN 신호에 연결할 수 있게 하는 기술
- BSS(Basic Service Set)는 기본 서비스 집합을 의미하며, 단순 공유기를 통해 네트워크에 접속하는 것이 아닌 동일 BSS 내에 있는 AP들과 장치들이 서로 통신이 가능한 구조
- ESS(Extended Service Set)는 하나 이상의 연결된 BSS 그룹입니다.



##### [부록] 무선 LAN을 이루는 주파수

- 무선 LAN(WLAN, Wireless Local Area Network)은 무선 신호 전달 방식을 이용하여 2대 이상의 장치를 연결하는 기술입니다.
- 비유도 매체인 공기에 주파수를 쏘아 무선 통신망을 구축하는데, 주파수 대역은 2.4GHz 대역 또는 5GHz 대역 중 하나를 써서 구축합니다.
- 2.4GHz
  - 장애물에 강함
  - 호환성 좋음. (오래된 노트북, 휴대폰과도 연결가능)
  - 전자레인지, 무선 등 전파 간섭이 일어나기도 함.
  - 커버리지가 적음.
- 5HGz
  - 사용할 수 있는 채널 많음.
  - 상대적으로 깨끗한 전파환경
  - 속도가 더 빠름.
  - 커버리지가 작음.
