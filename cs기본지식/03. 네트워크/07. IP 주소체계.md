## IP 주소체계

---

##### #1: 이진수 이해하기

- 이진수: 0과 1, 두개의 숫자로 표한하는 "이진법"으로 표현하는 수
- 이진수 표현
  1. 100101b (b를 덧붙임(b는 binary의 약자))
  2. 100101(2) ((2)를 덧붙임, 주로 수학에서 쓰임)
  3. 0b100101 (앞에 0b를 덧붙임)
- 각각의 자리는 "비트"라고 할 수 있으며 0인지 1인지를 통해 해당 수 1또는 2,4 등을 더하지 않거나 더하는 걸 기반으로 수를 표현합니다.



##### #2: IPv4와 IPv6

- IPv4
  - 32비트, 2^32개의 주소(41억 9천만 주소) 표현
    8비트 단위로 점을 찍어 4개로 구분(8비트의 단위를 옥텟이라고도함) 8비트를 10진수로 표현
    부족하기 때문에 NAT, 서브네팅 여러개의 부수적인 기술이 필요.
- IPv6
  - 128비트, 2^ 128개의 주소 표현(많은 주소 처리가능하며 NAT, 서브네팅이 필요하지 않음.)
    16비트씩 8개로 구분, 16비트는 16진수로 변환되어 콜론(:)으로 구분하여 표시하며 앞의 연속되는 0은 생략될 수 있음.
  - 앞 64비트: 네트워크, 뒤 64비트: 인터페이스 주소
  - IPSec이 내장되어 있음: 데이터 패킷을 암호화 하는 보안 네트워크 프로토콜 제품군
  - IPv4 헤더의 불필요한 필드를 제거하여 보다 빠른 처리 가능
    - IPv4는 체크섬이 있지만 IPv6는 체크섬이 없다.
    - IPv6는 헤더의 효율화를 위해 CRC(순환중복검사)를 제외합니다. 
      다만 상위 프로토콜(TCP, UDP)에서 이미 체크섬이 있기 때문에 이를 제거할 수 있습니다.
    - 참고로 UDP를 사용할 때 체크섬 필드는 선택사항이지만 UDP + IPv6로 사용할 때는 반드시 체크섬 필드를 사용한다고 설정해야 합니다.
    - IPv4는 헤더가 가변길이이지만 IPv6는 고정길이(40바이트)라서 “인터넷 헤더길이’에 대한 정보가 삭제되었음. (이외에도 여러가지 불필요한 정보 삭제됨)
- CRC
  - 순환중복검사로 네트워크상에서 데이터에 오류가 있는지 확인하기 위한 체크값을 결정하는 방식
    데이터를 전송하기 전에 주어진 데이터의 값에 따라 CRC 값을 계산하여 데이터에 붙여 전송하고, 데이터 전송이 끝난 후 받은 데이터의 값으로 다시 CRC 값을 계산하게 된다. 이어서 두 값을 비교하고, 이 두 값이 다르면 데이터 전송 과정에서 잡음 등에 의해 오류가 덧붙여 전송된 것임을 알 수 있습니다.
- TTL은 HOP limit로 대체
  - TTL이란? IPv4에서 TTL 필드는 패킷이 네트워크에서 무한순환하지 않도록 하는 변수입니다.
    패킷이 네트워크에서 라우터를 거칠 때마다TTL 값이 1씩 감소합니다. 값이 0이 되면 패킷이 폐기됩니다.
- Q. IPv4와 IPv6 어떤게 좋나요?더 빠를까?
  - IPv6는 IPv4보다 많은 주소를 표현할 수 있습니다. 또한 IPv4보다 불필요한 헤더가 삭제되어서 빠르고 기본적으로 IPSec이라는 네트워크 보안제품군이 포함되었기 때문에 보안적인 측면에서도 좋습니다.
    보통은 IPv6를 사용하는 것이 IPv4보다 속도가 더 빠르지만 일부 사용사례에서는 속도가 느리다고 알고 있습니다.



##### #3: 클래스풀 (Glassful IP Addressing)

- IP 주소는 인터넷 주소로 네트워크 주소, 호스트 주소 즉, 두 부분으로 나뉩니다.
  네트워크 주소는 호스트들을 모은 네트워크를 지칭, 네트워크 주소가 동일 = 로컬 네트워크 / 호스트 주소: 호스트를 구분하기 위한 주소
  - IPv4를 기준으로 설명합니다.
  - 네트워크 호스트는 컴퓨터 네트워크에 연결된 컴퓨터나 기타 장치
- 정의
  - 네트워크 주소를 매기고 그에 따라 네트워크의 크기를 다르게 구분하여 클래스를 할당하는 주소체계
  - 구분하는 기준자(첫, 2, 3 옥텟)을 서브넷 마스크라고 함.
  - Class A (첫번째 옥텟만 네트워크 주소로 사용, 3개의 옥텟은 호스트 주소)
    - 2^24 - 2 = 한 네트워크당 16,777,214 호스트 ID(약 1600만개) / 0
    - 네트워크 주소 범위: 1~126로 시작
      원래는 127.255.255.255까지 포함하지만 127.X는 **루프백 주소**이기 때문에 포함 X
      0.0.0.0도 특수 주소로 포함 X(알 수 없는 대상에 달아 놓는 임시 주소)
  - Class B (두번째 옥텟까지 네트워크 주소로 사용, 2개의 옥텟은 호스트 주소)
    - 2^16 - 2 = 한 네트워크당 65534 호스트 ID(6만 5천개) / 10
    - 네트워크 주소 범위: 127 ~ 191로 시작
  - Class C (세번째 옥텟까지 네트워크 주소로 사용, 1개의 옥텟만 호스트 주소
    - 2^8 - 2 = 한 네트워크당 254 호스트 ID / 110
    - 네트워크 주소 범위: 192 ~ 223로 시작
  - Q. 왜 2개를 빼나요?
    - 맨 앞자리는 네트워크 주소로 남겨두며 마지막 주소는 브로드캐스팅 주소로 남겨놓습니다.
  - 문제점
    - 네트워크의 크기가 모두 같은 경우 큰 네트워크를 필요로 하는 조직은 여러개를 확보해야 하는 어려움.
      작은 네트워크가 필요한 조직의 경우 너무 많은 IP를 가져가므로 IP가 낭비됨.



##### #4: 클래스리스와 서브넷마스크, 서브네팅

- 클래스풀의 단점을 해결하기 위해 클래스리스가 나왔습니다.
  클래스로 나누는 것이 아닌 서브넷 마스크를 중심으로 어디까지가 네트워크 주소고 어디까지가 호스트 주소인지를 나눕니다.
  - 서브네팅: 네트워크를 나눈다는 의미
  - 서브넷: 서브 네트워크, 쪼개진 네트워크
  - 서브넷마스크: 서브 네트워크를 위한 비트 마스크
- 참고로 현재 저희의 주소체계는 클래스리스를 사용합니다.
- **서브넷 마스크**
  - 네트워크 주소 부분만 모두 1, 호스트 주소 부분은 0으로 설정해서 나눈다.
  - Q. 10개의 사무실이 있으며 사무실당 12개의 장치를 연결해야 한다면?
    - 한 서브네트워크(서브넷)당 123.12.12.12
      /28로 16개의 네트워크를 확보해야. 16 - 2 = 14개 장치까지 가능



##### #5: 공인 IP(public IP)와 사설 IP(private IP)와 NAT

- IP주소의 부족을 공인IP(public IP)와 사설IP(private IP)로 나누고 중간에 NAT이라는 기술을 통해 해결합니다.
  NAT (Network Address Translation)는 패킷이 트래픽 라우팅 장치를 통해 전송되는 동안 패킷의 IP주소를 변경, IP 주소를 다른 IP 주소로 매핑하는 방법입니다.
- NAT을 통해 내부 네트워크 IP가 노출되지 않는다는 점. (다르게 설정)이 장점입니다.
- 공유기와 NAT
  - 실생활에서 인터넷 회선 하나를 개통하고 보통 공유기를 써서 wifi를 만들곤 하는데 이 때 여러 대의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속하게 됩니다.
    공유기의 상세 설명을 보면 NAT 기능을 제공한다고 써있습니다.
